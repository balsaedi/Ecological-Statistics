<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS | Ecological Analysis</title>
  <meta name="description" content="Chapter 3 TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS | Ecological Analysis" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS | Ecological Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS | Ecological Analysis" />
  
  
  

<meta name="author" content="Basim Alsaedi" />


<meta name="date" content="2024-11-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hypothesis-testing.html"/>
<link rel="next" href="correlation-covariance-geostatistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SHORT TITLE HERE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> INTRODUCTION</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-distributions"><i class="fa fa-check"></i><b>1.1</b> Data Distributions</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#types-of-distribution"><i class="fa fa-check"></i><b>1.1.1</b> Types of Distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#hands-on-exercises"><i class="fa fa-check"></i><b>1.2</b> <span style="color: green;"><strong>Hands-on Exercises</strong></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>2</b> HYPOTHESIS TESTING</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#parametric-tests"><i class="fa fa-check"></i><b>2.2</b> Parametric tests</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#parametric-single-sample-test"><i class="fa fa-check"></i><b>2.2.1</b> Parametric single-sample test</a></li>
<li class="chapter" data-level="2.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#parametric-two-sample-test"><i class="fa fa-check"></i><b>2.2.2</b> Parametric two-sample test</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#nonparametric-test"><i class="fa fa-check"></i><b>2.3</b> Nonparametric test</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#nonparametric-one-sample-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>2.3.1</b> Nonparametric One-Sample Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="2.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#nonparametric-two-sample-paired-sign-test-and-paired-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>2.3.2</b> Nonparametric two-sample paired sign test and paired Wilcoxon Signed Rank Test</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-way-anova"><i class="fa fa-check"></i><b>2.4</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#parametric-one-way-anova"><i class="fa fa-check"></i><b>2.4.1</b> Parametric One-Way ANOVA</a></li>
<li class="chapter" data-level="2.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#nonparametric-one-way-anova-kruskal-wallis-test"><i class="fa fa-check"></i><b>2.4.2</b> Nonparametric One-Way ANOVA (Kruskal-Wallis Test)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hands-on-exercise"><i class="fa fa-check"></i><b>2.5</b> <span style="color: green;"><strong>Hands-on Exercise</strong></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="test-for-autocorrelation-and-temporal-effects.html"><a href="test-for-autocorrelation-and-temporal-effects.html"><i class="fa fa-check"></i><b>3</b> TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="test-for-autocorrelation-and-temporal-effects.html"><a href="test-for-autocorrelation-and-temporal-effects.html#test-for-autocorrelation-using-the-sample-autocorrelation-function"><i class="fa fa-check"></i><b>3.1</b> Test for Autocorrelation Using the Sample Autocorrelation Function</a></li>
<li class="chapter" data-level="3.2" data-path="test-for-autocorrelation-and-temporal-effects.html"><a href="test-for-autocorrelation-and-temporal-effects.html#an-example-on-site-wide-temporal-effects"><i class="fa fa-check"></i><b>3.2</b> An Example on Site-Wide Temporal Effects</a></li>
<li class="chapter" data-level="3.3" data-path="test-for-autocorrelation-and-temporal-effects.html"><a href="test-for-autocorrelation-and-temporal-effects.html#tests-for-trend"><i class="fa fa-check"></i><b>3.3</b> TESTS FOR TREND</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html"><i class="fa fa-check"></i><b>4</b> CORRELATION, COVARIANCE, GEOSTATISTICS</a>
<ul>
<li class="chapter" data-level="4.1" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> INTRODUCTION</a></li>
<li class="chapter" data-level="4.2" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#correlation-and-covariance"><i class="fa fa-check"></i><b>4.2</b> CORRELATION AND COVARIANCE</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#pearsons-correlation-coefficient"><i class="fa fa-check"></i><b>4.2.1</b> Pearson’s Correlation Coefficient</a></li>
<li class="chapter" data-level="4.2.2" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#spearmans-and-kendalls-correlaton-coeefficients"><i class="fa fa-check"></i><b>4.2.2</b> Spearman’s and Kendall’s Correlaton Coeefficients</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#geostatistics"><i class="fa fa-check"></i><b>4.3</b> GEOSTATISTICS</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#variogram-modelling"><i class="fa fa-check"></i><b>4.3.1</b> Variogram Modelling</a></li>
<li class="chapter" data-level="4.3.2" data-path="correlation-covariance-geostatistics.html"><a href="correlation-covariance-geostatistics.html#kriging"><i class="fa fa-check"></i><b>4.3.2</b> Kriging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html"><i class="fa fa-check"></i><b>5</b> LINEAR REGRESSION ANALYSIS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#simple-linear-regression-analysis"><i class="fa fa-check"></i><b>5.1</b> Simple Linear Regression Analysis</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#empirical-model-building-regression-analysis"><i class="fa fa-check"></i><b>5.1.1</b> Empirical model-building-regression analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#interpreting-the-regression-results"><i class="fa fa-check"></i><b>5.1.2</b> Interpreting the regression results</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>5.1.3</b> R-squared and Adjusted R-Squared</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#data-transformation-versus-generalized-linear-model"><i class="fa fa-check"></i><b>5.2</b> Data transformation versus generalized linear model</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#multiple-linear-regression-mlr-model"><i class="fa fa-check"></i><b>5.3</b> Multiple Linear Regression (MLR) model</a></li>
<li class="chapter" data-level="5.4" data-path="linear-regression-analysis.html"><a href="linear-regression-analysis.html#hands-on-exercise-1"><i class="fa fa-check"></i><b>5.4</b> <span style="color: green;"><strong>Hands-on Exercise</strong></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conventional-and-probabilistic-risk-assessment.html"><a href="conventional-and-probabilistic-risk-assessment.html"><i class="fa fa-check"></i><b>6</b> CONVENTIONAL AND PROBABILISTIC RISK ASSESSMENT</a>
<ul>
<li class="chapter" data-level="6.1" data-path="conventional-and-probabilistic-risk-assessment.html"><a href="conventional-and-probabilistic-risk-assessment.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="conventional-and-probabilistic-risk-assessment.html"><a href="conventional-and-probabilistic-risk-assessment.html#conventional-or-point-risk-estimation"><i class="fa fa-check"></i><b>6.2</b> Conventional or Point Risk Estimation</a></li>
<li class="chapter" data-level="6.3" data-path="conventional-and-probabilistic-risk-assessment.html"><a href="conventional-and-probabilistic-risk-assessment.html#probabilistic-risk-assessment-using-monte-carlo-simulation"><i class="fa fa-check"></i><b>6.3</b> Probabilistic Risk Assessment Using Monte Carlo Simulation</a></li>
<li class="chapter" data-level="6.4" data-path="conventional-and-probabilistic-risk-assessment.html"><a href="conventional-and-probabilistic-risk-assessment.html#practical-exercise"><i class="fa fa-check"></i><b>6.4</b> <span style="color: green;"><strong>Practical Exercise</strong></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>7</b> Datasets</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecological Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="test-for-autocorrelation-and-temporal-effects" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> TEST FOR AUTOCORRELATION AND TEMPORAL EFFECTS<a href="test-for-autocorrelation-and-temporal-effects.html#test-for-autocorrelation-and-temporal-effects" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Environment Data is not always stable or stationary over time or space and is frequently subjected to sustained or cyclical change to the affecting factors. These concepts will help us understand the temporal effects better;</p>
<p><strong>Temporal Trends: </strong> refer to changes in a variable or phenomenon over time. Consider monitoring soil nitrogen levels in agricultural field over several years. There might be temporal rise of nitrogen immediately after application of nitrogen-based fertilizer and return back to almost the average state after time. Although there might be a general increase in soil nitrogen levels, but they won’t match the immediate spikes after fertilizer application.</p>
<p><strong>Autocorrelation</strong> or <strong>serial correlation: </strong> is the
correlation between data values of the same variable. <strong>Positive autocorrelation</strong> means that values close in time/space tend to be similar while <strong>negative autocorrelation</strong> means that they tend to differ.</p>
<p><strong>Monotonic trend: </strong> this is a trend that is in one direction, either constantly upward or downwards. A good example are the levels of carbon dioxide(CO2) concentrations in the atmosphere, they have been consistently rising due to industrial activities and deforestation.</p>
<p><strong>Cyclic or Seasonal trend</strong> refer to patterns that repeat at regular intervals such as daily ,hourly or annually. These trends are usually affected by natural cycles, human activities or climatic conditions. For instance, these trends are evident in phosphorous levels in water bodies that might increase during rainy seasons due agricultural runoff and decline during dry seasons.</p>
<p>When testing for autocorrelation and temporal effects the data samples are assumed to have values that are independent or uncorrelated, and identically or similarly distributed. The data are said to be <em>autocorrelated</em> or <em>serially correlated</em> when this assumption is violated.</p>
<p>These are the tests that are used to check for autocorrelation:</p>
<ul>
<li><p><em>Sample Autocorrelation Function(ACF): </em> used for a single time series where data is normally distributed.</p></li>
<li><p><em>Rank von Neumann ratio test</em> used when the data samples evidence of nonnormality.</p></li>
<li><p><em>The complete block design ANOVA or Friedman test</em> is used for multiple different data samples for instance testing the concentration of ground water contaminant from multiple monitoring wells at a site.</p></li>
</ul>
<div id="test-for-autocorrelation-using-the-sample-autocorrelation-function" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Test for Autocorrelation Using the Sample Autocorrelation Function<a href="test-for-autocorrelation-and-temporal-effects.html#test-for-autocorrelation-using-the-sample-autocorrelation-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before testing for autocorrelation using the ACF method, the data sample should be;</p>
<ul>
<li>normally distributed.</li>
<li>stationary(that is, not trending).</li>
<li>free of outliers.</li>
<li>containing atleast 10 to 12 observations.</li>
</ul>
<p>… And here is how ACf is computed.</p>
<ol style="list-style-type: decimal">
<li>Arrange the data in lagged data pairs (<span class="math inline">\(x_{i}, x_{i + k}\)</span>), for <span class="math inline">\(i\)</span> = 1, 2, ….(<span class="math inline">\(n-k\)</span>), where;</li>
</ol>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(n\)</span> is the size of the data samples(number of data values therein).</li>
<li><span class="math inline">\(k\)</span> is the lag. i.e number of sampling events dates separating one data value in the pair from the second value. For instance a lag of 1 shows that the two value pairs were collected in consecutive time intervals(e.g days) while lag shows that the data value pairs were collected every each time interval</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Calculate the sample Autocorrelation coefficient <span class="math display">\[r_k = {{\sum^{n-k}_{i=1}(x_i-x^!)(x_{i+k}- x^!)}\over{\sum^n_{i=1}(x_i - x^!)^2}}\]</span> where;</li>
</ol>
<ul>
<li><span class="math inline">\(n\)</span> is the data sample size.</li>
<li><span class="math inline">\(k\)</span> is the lag</li>
<li><span class="math inline">\(x^!\)</span> is the data sample mean</li>
<li><span class="math inline">\(x_{i}, x_{i + k}\)</span> are the components of the data pairs formed based on the lag.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>If <span class="math inline">\(k\)</span> = 1, the sample autocorrelation coefﬁcient, <span class="math inline">\(r_1\)</span> is referred to as the ﬁrst order sample autocorrelation coefﬁcient. If <span class="math inline">\(k\)</span> = 2, <span class="math inline">\(r_2\)</span> is the second order coefﬁcient, and so on.</p></li>
<li><p>Lets breakdown the possible results of autocorrelation;</p></li>
</ol>
<ul>
<li><span class="math inline">\(r_0\)</span> = 1: Autocorrelation at lag 0 is always one because a value is perfectly correlated with itself.</li>
<li>Random Data: if the data is random, most autocorrelation coefficients will be close to zero, and will decrease further as the lag increases.</li>
<li>Autocorrelated Data: If there’s autocorrelation, some coefficients(<span class="math inline">\(r_k\)</span>) will be significantly larger than zero, but their strength decreases with higher lags.</li>
<li>Trend in data: If there is a trend, coefficients wont diminish, showing persistent correlation.</li>
</ul>
<p>As a summary, the normally distributed data, <span class="math inline">\(r_k\)</span> should be close to zero if there is no correlation. At a 95% confidence level, autocorrelation is insignificant if no <span class="math inline">\(r_k\)</span> exceeds the threshold <span class="math inline">\(2\over{\sqrt{n}}\)</span>. There result of each autocorrelation are therefore plotted in a correlogram and the confidence limits are show as the horizontal lines.</p>
<p><span style="color: orange;"><strong>Try it!</strong></span></p>
</div>
<div id="an-example-on-site-wide-temporal-effects" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> An Example on Site-Wide Temporal Effects<a href="test-for-autocorrelation-and-temporal-effects.html#an-example-on-site-wide-temporal-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Analysis of Site-Wide Temporal Effects on Groundwater Manganese Concentrations</strong></p>
<p>Generate the data</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb81-2"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb81-3"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-3" tabindex="-1"></a></span>
<span id="cb81-4"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-4" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb81-5"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb81-6"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-6" tabindex="-1"></a></span>
<span id="cb81-7"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-7" tabindex="-1"></a><span class="co"># Generate synthetic manganese concentration data</span></span>
<span id="cb81-8"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-8" tabindex="-1"></a>Mn_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">2.8</span>, <span class="fl">4.1</span>, <span class="fl">3.9</span>, <span class="fl">5.2</span>, <span class="fl">4.8</span>, <span class="fl">6.0</span>, <span class="fl">5.7</span>,  <span class="co"># Well 1</span></span>
<span id="cb81-9"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-9" tabindex="-1"></a>               <span class="fl">3.2</span>, <span class="fl">2.5</span>, <span class="fl">3.8</span>, <span class="fl">3.7</span>, <span class="fl">5.0</span>, <span class="fl">4.6</span>, <span class="fl">5.8</span>, <span class="fl">5.5</span>,  <span class="co"># Well 2</span></span>
<span id="cb81-10"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-10" tabindex="-1"></a>               <span class="fl">3.6</span>, <span class="fl">3.0</span>, <span class="fl">4.2</span>, <span class="fl">4.0</span>, <span class="fl">5.3</span>, <span class="fl">4.9</span>, <span class="fl">6.1</span>, <span class="fl">5.8</span>,  <span class="co"># Well 3</span></span>
<span id="cb81-11"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-11" tabindex="-1"></a>               <span class="fl">3.3</span>, <span class="fl">2.6</span>, <span class="fl">3.9</span>, <span class="fl">3.8</span>, <span class="fl">5.1</span>, <span class="fl">4.7</span>, <span class="fl">5.9</span>, <span class="fl">5.6</span>)  <span class="co"># Well 4</span></span>
<span id="cb81-12"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-12" tabindex="-1"></a></span>
<span id="cb81-13"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-13" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb81-14"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-14" tabindex="-1"></a>Mn2Data8 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-15"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-15" tabindex="-1"></a>  <span class="at">Mn =</span> Mn_values,</span>
<span id="cb81-16"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-16" tabindex="-1"></a>  <span class="at">Location =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Well1&quot;</span>, <span class="st">&quot;Well2&quot;</span>, <span class="st">&quot;Well3&quot;</span>, <span class="st">&quot;Well4&quot;</span>), <span class="at">each =</span> <span class="dv">8</span>),</span>
<span id="cb81-17"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-17" tabindex="-1"></a>  <span class="at">Time =</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&quot;Q&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb81-18"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-18" tabindex="-1"></a>)</span>
<span id="cb81-19"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-19" tabindex="-1"></a></span>
<span id="cb81-20"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-20" tabindex="-1"></a><span class="co"># Convert factors</span></span>
<span id="cb81-21"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-21" tabindex="-1"></a>Mn2Data8<span class="sc">$</span>Location <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Mn2Data8<span class="sc">$</span>Location)</span>
<span id="cb81-22"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-22" tabindex="-1"></a>Mn2Data8<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Mn2Data8<span class="sc">$</span>Time)</span>
<span id="cb81-23"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-23" tabindex="-1"></a></span>
<span id="cb81-24"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-24" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb81-25"><a href="test-for-autocorrelation-and-temporal-effects.html#cb81-25" tabindex="-1"></a><span class="fu">head</span>(Mn2Data8)</span></code></pre></div>
<pre><code>##    Mn Location Time
## 1 3.5    Well1   Q1
## 2 2.8    Well1   Q2
## 3 4.1    Well1   Q3
## 4 3.9    Well1   Q4
## 5 5.2    Well1   Q5
## 6 4.8    Well1   Q6</code></pre>
<p>Groundwater manganese concentrations have been monitored quarterly across four wells for a period of two years (eight quarters). The data set above, 2009), includes measurements from each well per quarter. The goal is to determine whether there is a site-wide temporal trend in manganese concentrations over time.</p>
<p>To establish whether a time trend exists, we must first check for spatial variability among the four wells. If the manganese concentrations do not significantly differ across wells, we can then assess whether concentrations change over time.</p>
<p>Here is the process that will be followed;</p>
<ol style="list-style-type: decimal">
<li>Check for Spatial Variability (Homogeneity) by;</li>
</ol>
<ul>
<li>Testing whether the means or medians of the four well datasets are statistically equal.</li>
<li>Checking If the datasets show normality and homogeneity of variances, a two-way ANOVA without replication (Complete Block Design) is appropriate. Otherwise, the non-parametric Friedman test is used.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Check for Temporal Trends by;</li>
</ol>
<ul>
<li>Checking for a significant trend over time if no spatial variability is found.</li>
<li>A two-way ANOVA is performed again, switching the roles of <code>Time</code> and <code>Location</code> where initially <code>Time</code> was the factor of interest and <code>Location</code> as a blocking factor.</li>
</ul>
<p>The ANOVA model follows the equation:
<span class="math display">\[{Y_{ij}}={\mu + \alpha_i + \beta_j + \epsilon_{ij}}\]</span>
Where:</p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span> is the Manganese concentration</li>
<li><span class="math inline">\(\mu\)</span> is the overall mean</li>
<li><span class="math inline">\(\alpha_i\)</span> represents the effect of the well (location)</li>
<li><span class="math inline">\(\beta_j\)</span> represents the effect of time (quarter)</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> is the error term</li>
</ul>
<p>The hypothesis tests:</p>
<ul>
<li><strong>For spatial variability:</strong> <span class="math inline">\(H_0:\mu_1=\mu_2=\mu_3=\mu_4\)</span> (no significant difference between wells)</li>
<li><strong>For temporal trend</strong> <span class="math inline">\(H_0:\mu_{Q1}=\mu_{Q2}=...=\mu_{Q8}\)</span>(no significant difference across quarters)</li>
</ul>
<p>Check for variability</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="test-for-autocorrelation-and-temporal-effects.html#cb83-1" tabindex="-1"></a><span class="co"># Step 1: Check for Spatial Variability</span></span>
<span id="cb83-2"><a href="test-for-autocorrelation-and-temporal-effects.html#cb83-2" tabindex="-1"></a>Mn2.anova1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Mn <span class="sc">~</span> Location <span class="sc">+</span> Time, <span class="at">data =</span> Mn2Data8)</span>
<span id="cb83-3"><a href="test-for-autocorrelation-and-temporal-effects.html#cb83-3" tabindex="-1"></a><span class="fu">summary</span>(Mn2.anova1)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Location     3   0.57   0.189   125.5 1.44e-13 ***
## Time         7  35.63   5.091  3387.1  &lt; 2e-16 ***
## Residuals   21   0.03   0.002                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Results;</p>
<ul>
<li><strong>Location</strong>: p_value(denoted as Pr(&gt;F) on the table above) is less than 0.05 - therefore there is a significant spatial variability</li>
<li><strong>Time</strong>: p_value is less than 0.05 - there is a siginfant temporal trend.</li>
</ul>
<p>If there was no spatial variability we could have proceed to test the time trend. However, lets just proceed to show you how it is done.</p>
<p>Check the code below</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="test-for-autocorrelation-and-temporal-effects.html#cb85-1" tabindex="-1"></a><span class="co"># Step 2: Check for Temporal Effects</span></span>
<span id="cb85-2"><a href="test-for-autocorrelation-and-temporal-effects.html#cb85-2" tabindex="-1"></a>Mn2.anova2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Mn <span class="sc">~</span> Time <span class="sc">+</span> Location, <span class="at">data =</span> Mn2Data8)</span>
<span id="cb85-3"><a href="test-for-autocorrelation-and-temporal-effects.html#cb85-3" tabindex="-1"></a><span class="fu">summary</span>(Mn2.anova2)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Time         7  35.63   5.091  3387.1  &lt; 2e-16 ***
## Location     3   0.57   0.189   125.5 1.44e-13 ***
## Residuals   21   0.03   0.002                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>P-value is far much less than 0.05. The results confirm that manganese concentrations vary significantly over time.</p>
<p><span style="color: green;"><strong>Practical Exercise</strong></span></p>
<hr />
<p><span style="color: brown;"><strong>Solution</strong></span></p>
<p><span style="color: brown;"><strong>________________________________________________________________________________</strong></span></p>
</div>
<div id="tests-for-trend" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> TESTS FOR TREND<a href="test-for-autocorrelation-and-temporal-effects.html#tests-for-trend" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hypothesis-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-covariance-geostatistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/balsaedi/RCourse/edit/main/03-autocorrelation_and_temporal_effects_testing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/balsaedi/RCourse/blob/main/03-autocorrelation_and_temporal_effects_testing.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
